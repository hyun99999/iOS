# ch28.오류처리

- 오류처리(Error Handling) 이란 프로그램이 오류를 일으켰을 때 이것을 감지하고 회복시키는 일련의 과정입니다.
- 오류의 표현
  - 스위프트에서 오류 error 는 **Error** 라는프로토콜을 준수하는 타입의 값을 통해 표현.
  - Error 프로토콜은 사실상 요구사항이 없는 빈 프로토콜일 뿐이지만, 오류를 표현하기 위한 타입(주로 열거형)은 채택.
- 오류의 종류를 미리 예상한 다음, 오류 때문에 정상진행이 되지 않을 때라면 오류를 던져 **Throw Error** 주면 된다.

## 오류 포착 및 처리
- 스위프트에는 오류를 처리하기 위한 네가지 방법.
> 1. 함수에서 발생한 오류를 해당 함수를 호출한 코드에 알리는 방법
> 2. do-catch 구문을 이용하여 오류를 처리하는 방법
> 3. 옵셔널 값으로 오류를 처리하는 방법
> 4. 오류가 발생하지 않을 것이라고 확신하는 방법
1. 함수에서 발생한 오류를 해당 함수를 호출한 코드에 알리는 방법

  > - **try** 키워드로 던져진 오류를 받을 수 있다. try,try?, try! 등으로 표현 가능.
  > - 함수, 메서드, 이니셜라이저의 매개변수 뒤에 **throws** 키워드를 사용하면 오류를 던질 수 있다. 호출당시 오류가 발생하면 자신을 호출한 코드에 오류를 던져서 오류를 알릴 수 있다.
  > - 오류를 던질 수 있는 코드를 호출하는 코드는 반드시 오류를 처리할 수 있는 구문을 작성.
2. do-catch 구문을 이용하여 오류를 처리하는 방법
  ```swift
  do {
    try //오류 발생 가능 코드
    //오류가 발생하지 않으면 실행할 코드
  } catch 오류 패턴 {
    //만약 catch 뒤에 오류의 종류를 명시하지 않고 코드 블록을 생성할 경우 암시적으로 error 라는 이름의 지역상수가 오류의 내용을 들어간다.
    //처리코드
  }
  ```
3. 옵셔널 값으로 오류를 처리하는 방법
  - **try?** 를 사용하여 옵셔널 값으로 변환하여 오류를 처리 가능. 오류를 던지면 그 코드의 반환값은 nil이 된다.
4. 오류가 발생하지 않을 것이라고 확신하는 방법
  - **try!** 키워드를 사용.
  - 오류를 던질 수 있는 함수 등을 호출할 때 오류가 절대 발생하지 않을 것이라고 확신할 수 있는 상황에서 사용.

- 다시 던지기(rethrows)
  - **rethrows** 키워드를 사용하여 자신의 매개변수로 전달받은 함수가 오류를 던진다는 것을 나타낼 수 있다.
  - 다시 던지기 함수는 기본적으로 스스로 오류를 던지지 못한다. 즉, 자신 내부에 직접적으로 **throw** 구문을 사용하지 못한다. 그러나 catch 절 내부에서는 작성 가능.
  - 다시 던지기 함수나 메서드가 오류를 던지는 함수를 do-catch 구문 내부에서 호출하고 catch 절 내부에서 다른 오류를 던짐으로써 오류를 던지는 함수에서 발생한 오류를 제어 가능. 
  - 프로토콜 요구사항 중 다시 던지기 메서드가 있다면 던지기 메서드를 구현한다고 해서 충족 못 시킨다. 그러나 던지기 메서드가 있다면 다시 던지기 메서드를 구현해서 충족시킬 수 있다.
  - 부모클래스의 다시 던지기 메서드는 자식클래스의 던지기 메서드로 재정의 불가. 부모클래스의 던지기 메서드는 자식클래스에서 다시 던지기 메서드로 재정의 가능.
- 후처리 defer
  - **defer** 구문을 사용하여 현재 코드 블록을 나가기 전에 꼭 실행해야 하는 코드를 작성 가능. 현재 코드 범위를 벗어나기 전까지 실행을 미루고 있다가 벗어나기 직전에 실행.
  - defer 구문은 오류처리 상황뿐만 아니라 함수,메서드,반복문,조건문 등등에도 사용 가능.
  - defer 구문 내부에는 break, return 등과 같이 빠져나갈 수 있는 코드 또는 오류를 던지는 코드는 작성 불가.
  - 여러개의 defer 구문이 하나의 블럭에 있다면 역순으로 실행.
